<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦æœ¯ç½—ç›˜ (Academic Compass)</title>
    <!-- å¼•å…¥Tailwind CSSï¼Œç”¨äºå¿«é€Ÿæ„å»ºæ¼‚äº®çš„ç•Œé¢ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥Google Fontsï¼Œä½¿ç”¨æ›´ç°ä»£çš„å­—ä½“ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* è‡ªå®šä¹‰å­—ä½“å’Œæ»šåŠ¨æ¡æ ·å¼ */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* ä¸ºæš—è‰²æ¨¡å¼ä¸‹çš„æ»šåŠ¨æ¡å¢åŠ æ ·å¼ï¼Œæå‡è´¨æ„Ÿ */
        .dark ::-webkit-scrollbar {
            width: 8px;
        }
        .dark ::-webkit-scrollbar-track {
            background: #28235d; /* æ·±ç´«è‰²èƒŒæ™¯ */
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #6d28d9; /* äº®ç´«è‰²æ»‘å— */
            border-radius: 4px;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #7c3aed;
        }
    </style>
    <script>
        // Tailwind CSS æš—è‰²æ¨¡å¼é…ç½®
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
</head>
<body class="bg-white dark:bg-slate-900 transition-colors duration-300">

    <div id="app" class="relative min-h-screen w-full p-4 sm:p-6 lg:p-8">
        
        <!-- å·¦ä¸Šè§’åº”ç”¨æ ‡é¢˜ -->
        <div class="absolute top-4 left-4 sm:top-6 sm:left-6 lg:top-8 lg:left-8">
            <h1 data-i18n-key="pageTitle" class="text-xl font-bold text-gray-800 dark:text-white flex items-center">
                å­¦æœ¯ç½—ç›˜ ğŸ§­
            </h1>
        </div>

        <!-- å³ä¸Šè§’çš„æ§åˆ¶æŒ‰é’®åŒºåŸŸ -->
        <header class="absolute top-4 right-4 sm:top-6 sm:right-6 lg:top-8 lg:right-8 flex items-center space-x-4">
            <!-- æ˜æš—æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
            <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-slate-800 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-slate-700 transition-colors">
                <!-- å¤ªé˜³å›¾æ ‡ (é»˜è®¤æ˜¾ç¤º) -->
                <svg id="theme-icon-light" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                <!-- æœˆäº®å›¾æ ‡ (æš—è‰²æ¨¡å¼ä¸‹æ˜¾ç¤º) -->
                <svg id="theme-icon-dark" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
            </button>
            <!-- è¯­è¨€åˆ‡æ¢æŒ‰é’® -->
            <div class="flex items-center bg-gray-200 dark:bg-slate-800 rounded-full p-1 text-sm font-medium">
                <button data-lang="zh-CN" class="lang-btn px-3 py-1 rounded-full bg-white dark:bg-purple-600 text-purple-600 dark:text-white">ç®€</button>
                <button data-lang="zh-TW" class="lang-btn px-3 py-1 rounded-full text-gray-600 dark:text-gray-400">ç¹</button>
                <button data-lang="en" class="lang-btn px-3 py-1 rounded-full text-gray-600 dark:text-gray-400">EN</button>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒºåŸŸï¼Œé‡‡ç”¨Gridå¸ƒå±€å®ç°1:1åŒæ  -->
        <main class="max-w-7xl mx-auto mt-20 grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- å·¦æ ï¼šä¿¡æ¯è¾“å…¥ -->
            <div class="bg-gray-50 dark:bg-slate-800/50 p-6 sm:p-8 rounded-2xl">
                <h2 data-i18n-key="inputTitle" class="text-2xl font-bold text-gray-900 dark:text-white mb-1">è¾“å…¥ä¿¡æ¯</h2>
                <p data-i18n-key="inputSubtitle" class="text-sm text-gray-500 dark:text-gray-400 mb-6">AIå°†è‡ªåŠ¨æœç´¢å¹¶åˆ†æä½ çš„æœªæ¥å¯èƒ½æ€§</p>
                
                <div class="space-y-5">
                    <div>
                        <label for="major-input" data-i18n-key="majorLabel" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ä½ çš„ä¸“ä¸š/å­¦ä½</label>
                        <!-- ã€UIä¼˜åŒ–ã€‘å¢åŠ äº† dark:text-white ç¡®ä¿æš—è‰²æ¨¡å¼ä¸‹è¾“å…¥æ–‡å­—ä¸ºç™½è‰² -->
                        <input type="text" id="major-input" data-i18n-key="majorPlaceholder" class="w-full px-4 py-2 bg-white dark:bg-slate-800 text-gray-900 dark:text-white border border-gray-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-purple-500 focus:outline-none transition" placeholder="ä¾‹å¦‚ï¼šPhD in Human-Computer Interaction">
                    </div>
                    <div>
                        <label for="interests-input" data-i18n-key="interestsLabel" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ä½ çš„ç ”ç©¶æ–¹å‘æˆ–æŠ€èƒ½ (å¯é€‰)</label>
                        <!-- ã€UIä¼˜åŒ–ã€‘å¢åŠ äº† dark:text-white ç¡®ä¿æš—è‰²æ¨¡å¼ä¸‹è¾“å…¥æ–‡å­—ä¸ºç™½è‰² -->
                        <input type="text" id="interests-input" data-i18n-key="interestsPlaceholder" class="w-full px-4 py-2 bg-white dark:bg-slate-800 text-gray-900 dark:text-white border border-gray-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-purple-500 focus:outline-none transition" placeholder="ä¾‹å¦‚ï¼šNatural Language Processing, User Research, Python">
                    </div>
                    <div>
                        <label for="resume-input" data-i18n-key="resumeLabel" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ç²˜è´´ä½ çš„ä¸ªäººç®€ä»‹æˆ–ç®€å† (å¯é€‰)</label>
                        <!-- ã€UIä¼˜åŒ–ã€‘å¢åŠ äº† dark:text-white ç¡®ä¿æš—è‰²æ¨¡å¼ä¸‹è¾“å…¥æ–‡å­—ä¸ºç™½è‰² -->
                        <textarea id="resume-input" rows="6" data-i18n-key="resumePlaceholder" class="w-full px-4 py-2 bg-white dark:bg-slate-800 text-gray-900 dark:text-white border border-gray-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-purple-500 focus:outline-none transition" placeholder="ç²˜è´´ä½ çš„ç®€å†æ–‡æœ¬åˆ°è¿™é‡Œï¼Œå¯ä»¥è·å¾—æ›´ä¸ªæ€§åŒ–çš„åˆ†æ..."></textarea>
                    </div>
                </div>
                
                <button id="analyze-button" class="mt-6 w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 dark:bg-purple-600 dark:hover:bg-purple-700 text-white font-bold rounded-lg shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5 disabled:bg-gray-400 disabled:dark:bg-slate-700 disabled:cursor-not-allowed">
                    <span data-i18n-key="analyzeButton">å¼€å§‹åˆ†æ</span>
                    <div id="spinner" class="hidden w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin inline-block ml-2"></div>
                </button>
            </div>

            <!-- å³æ ï¼šåˆ†ææŠ¥å‘Š -->
            <div class="bg-gray-50 dark:bg-slate-800/50 p-6 sm:p-8 rounded-2xl">
                <h2 data-i18n-key="reportTitle" class="text-2xl font-bold text-gray-900 dark:text-white mb-2">åˆ†ææŠ¥å‘Š</h2>
                <div class="w-full h-px bg-gray-200 dark:bg-slate-700 mb-6"></div>
                <div id="result-container" class="prose prose-blue dark:prose-invert max-w-none h-[500px] overflow-y-auto pr-2 text-gray-600 dark:text-gray-300 whitespace-pre-wrap">
                    <p data-i18n-key="reportPlaceholder">(è¯·åœ¨å·¦ä¾§è¾“å…¥ä¿¡æ¯åç‚¹å‡»â€œå¼€å§‹åˆ†æâ€)</p>
                </div>
            </div>

        </main>
    </div>

    <script>
        // --- DOM Element Selection ---
        const themeToggle = document.getElementById('theme-toggle');
        const themeIconLight = document.getElementById('theme-icon-light');
        const themeIconDark = document.getElementById('theme-icon-dark');
        const analyzeButton = document.getElementById('analyze-button');
        const spinner = document.getElementById('spinner');
        const resultContainer = document.getElementById('result-container');
        const majorInput = document.getElementById('major-input');
        const interestsInput = document.getElementById('interests-input');
        const resumeInput = document.getElementById('resume-input');
        const langButtons = document.querySelectorAll('.lang-btn');

        // --- Internationalization (i18n) ---
        const locales = {
            'en': {
                pageTitle: 'Academic Compass ğŸ§­', 
                inputTitle: 'Enter Information',
                inputSubtitle: 'The AI will automatically search and analyze your future possibilities',
                majorLabel: 'Your Major/Degree',
                majorPlaceholder: 'e.g., PhD in Human-Computer Interaction',
                interestsLabel: 'Your Research Interests or Skills (Optional)',
                interestsPlaceholder: 'e.g., Natural Language Processing, User Research, Python',
                resumeLabel: 'Paste your bio or resume (Optional)',
                resumePlaceholder: 'Paste your resume text here for a more personalized analysis...',
                analyzeButton: 'Analyze',
                reportTitle: 'Analysis Report',
                reportPlaceholder: '(Please enter information on the left and click "Analyze")',
                connecting: 'Connecting to the AI brain, please wait...',
                errorOccurred: 'An error occurred',
                connectionError: 'Connection error, please check:\n1. Is your internet connection stable?\n2. Check the browser console (F12) for error messages.',
                reportHeader: '--- Analysis Report ---',
                referencesHeader: '--- Cited References ---'
            },
            'zh-CN': {
                pageTitle: 'å­¦æœ¯ç½—ç›˜ ğŸ§­',
                inputTitle: 'è¾“å…¥ä¿¡æ¯',
                inputSubtitle: 'AIå°†è‡ªåŠ¨æœç´¢å¹¶åˆ†æä½ çš„æœªæ¥å¯èƒ½æ€§',
                majorLabel: 'ä½ çš„ä¸“ä¸š/å­¦ä½',
                majorPlaceholder: 'ä¾‹å¦‚ï¼šäººæœºäº¤äº’åšå£«',
                interestsLabel: 'ä½ çš„ç ”ç©¶æ–¹å‘æˆ–æŠ€èƒ½ (å¯é€‰)',
                interestsPlaceholder: 'ä¾‹å¦‚ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ã€ç”¨æˆ·ç ”ç©¶ã€Python',
                resumeLabel: 'ç²˜è´´ä½ çš„ä¸ªäººç®€ä»‹æˆ–ç®€å† (å¯é€‰)',
                resumePlaceholder: 'ç²˜è´´ä½ çš„ç®€å†æ–‡æœ¬åˆ°è¿™é‡Œï¼Œå¯ä»¥è·å¾—æ›´ä¸ªæ€§åŒ–çš„åˆ†æ...',
                analyzeButton: 'å¼€å§‹åˆ†æ',
                reportTitle: 'åˆ†ææŠ¥å‘Š',
                reportPlaceholder: '(è¯·åœ¨å·¦ä¾§è¾“å…¥ä¿¡æ¯åç‚¹å‡»â€œå¼€å§‹åˆ†æâ€)',
                connecting: 'æ­£åœ¨è¿æ¥äº‘ç«¯AIå¤§è„‘ï¼Œè¯·ç¨å€™...',
                errorOccurred: 'å‘ç”Ÿé”™è¯¯',
                connectionError: 'å‘ç”Ÿè¿æ¥é”™è¯¯ï¼Œè¯·æ£€æŸ¥ï¼š\n1. ä½ çš„ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®šï¼Ÿ\n2. æµè§ˆå™¨æ§åˆ¶å°(F12)æ˜¯å¦æœ‰æŠ¥é”™ä¿¡æ¯ï¼Ÿ',
                reportHeader: '--- åˆ†ææŠ¥å‘Š ---',
                referencesHeader: '--- ä¿¡æ¯æ¥æº ---'
            },
            'zh-TW': {
                pageTitle: 'å­¸è¡“ç¾…ç›¤ ğŸ§­',
                inputTitle: 'è¼¸å…¥è³‡è¨Š',
                inputSubtitle: 'AIå°‡è‡ªå‹•æœå°‹ä¸¦åˆ†æä½ çš„æœªä¾†å¯èƒ½æ€§',
                majorLabel: 'ä½ çš„å°ˆæ¥­/å­¸ä½',
                majorPlaceholder: 'ä¾‹å¦‚ï¼šäººæ©Ÿäº’å‹•åšå£«',
                interestsLabel: 'ä½ çš„ç ”ç©¶æ–¹å‘æˆ–æŠ€èƒ½ (å¯é¸)',
                interestsPlaceholder: 'ä¾‹å¦‚ï¼šè‡ªç„¶èªè¨€è™•ç†ã€ä½¿ç”¨è€…ç ”ç©¶ã€Python',
                resumeLabel: 'è²¼ä¸Šä½ çš„å€‹äººç°¡ä»‹æˆ–å±¥æ­· (å¯é¸)',
                resumePlaceholder: 'è²¼ä¸Šä½ çš„å±¥æ­·æ–‡æœ¬åˆ°é€™è£¡ï¼Œå¯ä»¥ç²å¾—æ›´å€‹äººåŒ–çš„åˆ†æ...',
                analyzeButton: 'é–‹å§‹åˆ†æ',
                reportTitle: 'åˆ†æå ±å‘Š',
                reportPlaceholder: '(è«‹åœ¨å·¦å´è¼¸å…¥è³‡è¨Šå¾Œé»æ“Šâ€œé–‹å§‹åˆ†æâ€)',
                connecting: 'æ­£åœ¨é€£æ¥é›²ç«¯AIå¤§è…¦ï¼Œè«‹ç¨å€™...',
                errorOccurred: 'ç™¼ç”ŸéŒ¯èª¤',
                connectionError: 'ç™¼ç”Ÿé€£æ¥éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ï¼š\n1. ä½ çš„ç¶²è·¯é€£ç·šæ˜¯å¦ç©©å®šï¼Ÿ\n2. ç€è¦½å™¨æ§åˆ¶å°(F12)æ˜¯å¦æœ‰å ±éŒ¯è¨Šæ¯ï¼Ÿ',
                reportHeader: '--- åˆ†æå ±å‘Š ---',
                referencesHeader: '--- è³‡è¨Šä¾†æº ---'
            }
        };

        let currentLang = 'zh-CN'; // é»˜è®¤è¯­è¨€

        function setLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            const translations = locales[lang];
            
            document.querySelectorAll('[data-i18n-key]').forEach(el => {
                const key = el.getAttribute('data-i18n-key');
                if (translations[key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        el.placeholder = translations[key];
                    } else {
                        el.textContent = translations[key];
                    }
                }
            });

            langButtons.forEach(btn => {
                if (btn.dataset.lang === lang) {
                    btn.classList.add('bg-white', 'dark:bg-purple-600', 'text-purple-600', 'dark:text-white');
                    btn.classList.remove('text-gray-600', 'dark:text-gray-400');
                } else {
                    btn.classList.remove('bg-white', 'dark:bg-purple-600', 'text-purple-600', 'dark:text-white');
                    btn.classList.add('text-gray-600', 'dark:text-gray-400');
                }
            });
        }

        langButtons.forEach(button => {
            button.addEventListener('click', () => {
                setLanguage(button.dataset.lang);
            });
        });

        // --- Theme Toggle ---
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themeIconDark.classList.remove('hidden');
            themeIconLight.classList.add('hidden');
        } else {
            document.documentElement.classList.remove('dark');
        }

        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.theme = isDark ? 'dark' : 'light';
            themeIconDark.classList.toggle('hidden', !isDark);
            themeIconLight.classList.toggle('hidden', isDark);
        });

        // --- API Call Logic ---
        const API_URL = 'https://academic-compass-backend-885033581194.us-central1.run.app/analyze';

        analyzeButton.addEventListener('click', async function() {
            if (!majorInput.value) {
                alert(currentLang === 'en' ? 'Major/Degree is required!' : 'ä¸“ä¸š/å­¦ä½æ˜¯å¿…å¡«é¡¹å“¦ï¼');
                return;
            }

            analyzeButton.disabled = true;
            spinner.classList.remove('hidden');
            resultContainer.innerHTML = `<p>${locales[currentLang].connecting}</p>`;

            const data = {
                major: majorInput.value,
                interests: interestsInput.value,
                resumeText: resumeInput.value,
                language: currentLang
            };

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                
                if (response.ok) {
                    let report = `<h3>${locales[currentLang].reportHeader}</h3><br>${result.analysis.replace(/\n/g, '<br>')}`;
                    if (result.sources && result.sources.length > 0) {
                        report += `<br><br><h3>${locales[currentLang].referencesHeader}</h3><br>`;
                        result.sources.forEach(source => {
                            report += `<p>- <a href="${source.link}" target="_blank" class="text-blue-500 dark:text-purple-400 hover:underline">${source.title}</a></p>`;
                        });
                    }
                    resultContainer.innerHTML = report;
                } else {
                    resultContainer.textContent = `${locales[currentLang].errorOccurred}: ${result.error}`;
                }

            } catch (error) {
                resultContainer.textContent = `${locales[currentLang].connectionError}\n\n${error.message}`;
            } finally {
                analyzeButton.disabled = false;
                spinner.classList.add('hidden');
            }
        });
        
        // --- Initial Setup ---
        setLanguage('zh-CN');

    </script>
</body>
</html>




